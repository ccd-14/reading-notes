## ICMP协议应用-traceroute
Traceroute程序可以获知IP数据报从一台主机到另一台主机所经过的路由，并且可以记录的路由IP地址可达255个。

Traceroute程序使用**ICMP报文**和IP首部中的**TTL字段**（生存周期）。TTL字段是由发送端初始设置一个8 bit字段。每个处理数据报的路由器都会将TTL减 1，如果接收的TTL为1，那么非目标主机（路由器）就会不转发该数据报，并给源主机发一份** ICMP“超时”信息**。该超时报文中源IP地址是发送该报文的主机/路由器。

:question:  判别是否到达目标主机：
Traceroute发送一份**UDP数据报**给目的主机，但它选择一个不可能的值作为 **UDP端口号**（大于 30 000），使目的主机的任何一个应用程序都不可能使用该端口。因为，当该数据报到达时，将使目的主机的 U D P模块产生一份“端口不可达”错误的 ICMP报文。这样， Traceroute程序所要做的就是区分接收到的 I C M P报文是超时还是端口不可达，以判断什么时候结束。