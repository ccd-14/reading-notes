# RARP:逆地址解析协议
如果局域网中的主机只知道自己的MAC地址，不知道IP地址，可以通过ARAP协议发出广播请求，由RARP服务器回答。
它是许多[无盘系统](https://baike.baidu.com/item/%E6%97%A0%E7%9B%98%E7%B3%BB%E7%BB%9F/10644051?fr=aladdin)在引导时用来获取IP地址。
## RARP数据帧格式
与[ARP数据帧格式](chap4_ARP-protocol.md/#ARP数据帧格式)基本相同，主要区别在于：
- RARP请求或应答帧类型为0X8035;
- RARP请求的操作码为3，应答操作码为4；

ARP和RARP以**广播方式请求**，以**单播方式应答**。

## RARP协议工作流程：
- 主机广播RARP请求，声明自己的MAC地址；
- 本网段的所有主机都会接受请求数据包，检查自身的RARP列表，若未找到，则丢弃该请求包；若找到，则发送响应数据包，提供IP地址；
- 源主机受到RARP响应信号，就可利用得到的IP地址通信；若一直未收到，表示初始化失败。

## 疑难点
### 1. NAT技术
IPv4最多只能支持40+亿个IP地址，不够使用。因此，引入**NAT**（Network Address Translation）技术,将内网设备的IP地址与对应的唯一的外网地址相互转化。内网设备使用同一外网地址，为了区分具体哪个设备在请求网络服务，可以通过内网IP地址和端口（port）号确定。具体转换过程如下：  



